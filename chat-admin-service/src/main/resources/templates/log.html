<!DOCTYPE html>
<!--suppress ThymeleafVariablesResolveInspection-->
<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/thymeleaf-extras-springsecurity4">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
</head>

<!-- 新 Bootstrap 核心 CSS 文件 -->
<link href="https://cdn.bootcss.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet">

<!-- 可选的Bootstrap主题文件（一般不使用） -->
<script src="https://cdn.bootcss.com/bootstrap/3.3.7/css/bootstrap-theme.min.css"></script>

<!-- jQuery文件。务必在bootstrap.min.js 之前引入 -->
<script src="https://cdn.bootcss.com/jquery/2.1.1/jquery.min.js"></script>

<!-- 最新的 Bootstrap 核心 JavaScript 文件 -->
<script src="https://cdn.bootcss.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
<script th:src="@{/js/extendPagination.js}"></script>
<body>
<div class="container-fluid" id="LG">
    <div class="row-fluid">
        <div class="span12">
            <h3>
                h3. 这是一套可视化布局系统.
            </h3>
            <div th:include="header :: html"></div>
            <div id="callBackPagination" class="piece">
                <div id="mainContent"></div>
                <div id="callBackPager"></div>
            </div>
        </div>
    </div>
</div>
</body>
<script type="text/javascript">

    $(document).ready(function () {
        var totalCount = Number($('#totalCount1').val()) || 500 , showCount = $('#showCount1').val(),

            limit = Number($('#limit').val()) || 15;

        createTable(1, limit, totalCount);



            $.ajax({
                       type: "get",
                       url: "http://localhost:9999/admin/logInfo",
                       dataType: "json",
                       data: {
                           "name": "",
                           "currentPage": currPage,
                           "pageSize": limit,
                           "sort": ""
                       },
                       success: function (data) {

                           if (data) {
                               var html = [], showNum = limit;
                               totalCount = data.total;
                               total = data.total;
                               if (total - (currPage * limit) < 0) showNum = total - ((currPage - 1) * limit);

                               html.push(' <table class="table table-hover table-striped">');

                               html.push(' <caption>总记录(' + total + ')</caption>');

                               html.push(' <thead><tr><th>账号</th><th>类型</th><th>时间</th></tr></thead><tbody>');

                               for (var i = 1; i <= showNum; i++) {
                                   var name = data.list[i-1].userName
                                   var ty = data.list[i-1].type
                                   var type = "";
                                   if (ty == 1) {type = "登录"}
                                   if (ty == 0) {type = "注销"}
                                   var cs = "success";
                                   if (i%2==0) {cs = "active"}
                                   html.push('<tr class='+cs+'><td>'+name+'</td>');
                                   html.push('<td>'+type+'</td>');
                                   html.push('<td>'+timestampToTime(data.list[i-1].time)+'</td>');
//                                   html.push('<td><button type="button" class="btn btn-info" data-toggle="modal" onclick="showInfo('+JSON.stringify(data.list[i-1]).replace(/"/g, '&quot;')+')">查看</button></td>');
                                   html.push('</tr>');

                               }

                               html.push('</tbody></table>');

                               var mainObj = $('#mainContent');

                               mainObj.empty();

                               mainObj.html(html.join(''));

                           }
                       }
                   })

        }
        $('#callBackPager').extendPagination({

                                                 totalCount: totalCount,

                                                 showCount: showCount,

                                                 limit: limit,

                                                 callback: function (curr, limit, totalCount) {

                                                     createTable(curr, limit, totalCount);

                                                 }

                                             });
    })
    function timestampToTime(timestamp) {
        var date = new Date(timestamp);//时间戳为10位需*1000，时间戳为13位的话不需乘1000
        Y = date.getFullYear() + '-';
        M = (date.getMonth()+1 < 10 ? '0'+(date.getMonth()+1) : date.getMonth()+1) + '-';
        D = date.getDate() + ' ';
        h = date.getHours() + ':';
        m = date.getMinutes() + ':';
        s = date.getSeconds();
        return Y+M+D+h+m+s;
    }
</script>
</html>